# 체중 세트 포인트 이론 검증 모델

이 프로젝트는 체중 세트 포인트 이론을 실증적으로 검증하기 위한 딥러닝 모델을 구현합니다.

## 프로젝트 개요

### 목적
- 체중 세트 포인트 이론의 실증적 검증
- 체중 변화에 영향을 미치는 요인 식별
- 개인별 체중 변화 예측 모델 개발

### 세트 포인트 방정식
```
W(t+1) = W(t) + k(Δt) × (SP − W(t))
```
여기서:
- W(t+1): 다음 시점의 체중
- W(t): 현재 체중
- k(Δt): 체중 조절률
- SP: 세트 포인트 (목표 체중)

## 데이터셋

### 시계열 데이터
- 체중
- 골격근량
- 체지방량
- 허리둘레
- 시간 간격 정보

### 정적 데이터
- 성별
- 생활습관 (활동량, 식습관, 음주, 흡연)
- 우울 점수
- 임상 데이터 (약물 복용 이력, 질병 이력 등)
- 기타 정보 (폐경 상태, 결혼 상태, 교육 수준, 소득 등)

## 모델 아키텍처

### 듀얼 브랜치 구조
1. 시계열 브랜치 (LSTM)
   - 시간에 따른 체중 변화 패턴 학습
   - 다층 LSTM 네트워크 사용

2. 정적 데이터 브랜치 (MLP)
   - 개인 특성 및 생활습관 정보 처리
   - 다층 퍼셉트론 네트워크 사용

### 멀티태스크 학습
- 다음 체중 예측 (W_pred)
- 세트 포인트 예측 (SP)
- 체중 조절률 예측 (k_pred)

## 설치 방법

1. 필요한 패키지 설치:
```bash
pip install -r requirements.txt
```

2. CUDA 지원 확인 (선택사항):
```bash
python -c "import torch; print(torch.cuda.is_available())"
```

## 사용 방법

1. 데이터 준비:
```python
time_series_data = pd.read_csv('your_time_series_data.csv')
static_data = pd.read_csv('your_static_data.csv')
```

2. 모델 실행:
```bash
python set_point_model.py
```

## 주요 기능

### 데이터 전처리
- 결측치 처리
- 정규화
- 원-핫 인코딩
- 시퀀스 데이터 생성

### 모델 학습
- Adam 옵티마이저 사용
- 학습률 스케줄링
- 체크포인트 저장
- 검증 손실 모니터링

### 특성 중요도 분석
- SHAP 값 계산
- 특성 영향도 시각화

## 하이퍼파라미터

- TIME_SERIES_DIM: 7 (시계열 특성 수)
- STATIC_DIM: 20 (정적 특성 수)
- HIDDEN_DIM: 64 (은닉층 차원)
- NUM_LAYERS: 2 (LSTM 레이어 수)
- BATCH_SIZE: 32
- NUM_EPOCHS: 100
- LEARNING_RATE: 0.001

## 결과 분석

1. 모델 성능 지표
   - 학습 손실
   - 검증 손실
   - 예측 정확도

2. 특성 중요도
   - SHAP 값 분석
   - 주요 영향 요인 식별

## 참고 사항

- 체크포인트는 'best_model_checkpoint.pth'에 저장됩니다.
- GPU가 가용한 경우 자동으로 사용됩니다.
- 데이터 로딩 부분은 실제 데이터에 맞게 수정이 필요합니다.

## 라이선스

이 프로젝트는 MIT 라이선스 하에 공개되어 있습니다.

# Setpoint Model Git

이 프로젝트는 setpoint 모델 관련 코드를 포함하고 있습니다.

## 테스트
이 줄은 Git 연동 테스트를 위해 추가되었습니다. 